<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>カテゴリ編集</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 24px; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 8px; }
    th { background: #f5f5f5; text-align: left; }
    .actions { margin-top: 12px; }
    .error { color: #c00; font-size: 12px; }
    .message { margin: 12px 0; color: #15803D; }
    .back { margin-left: 8px; }
  </style>
</head>
<body>
  <h1>カテゴリ編集</h1>

  <div class="message" th:if="${message}" th:text="${message}"></div>

  <form method="post" th:action="@{/categories/update}" th:object="${form}">
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>カテゴリ名</th>
          <th>色</th>
        </tr>
      </thead>
      <tbody>
        <tr th:each="cat, stat : *{categories}">
          <td>
            <span th:text="${cat.id}">1</span>
            <input type="hidden" th:field="*{categories[__${stat.index}__].id}">
          </td>
          <td>
            <input type="text" th:field="*{categories[__${stat.index}__].name}">
            <div class="error"
                 th:if="${#fields.hasErrors('categories[' + stat.index + '].name')}"
                 th:errors="*{categories[__${stat.index}__].name}"></div>
          </td>
          <td>
            <input type="color" th:field="*{categories[__${stat.index}__].color}">
          </td>
        </tr>
      </tbody>
    </table>

    <div class="actions">
      <button type="submit">保存</button>
      <a class="back" th:href="@{/todos}">ToDo一覧へ</a>
    </div>
  </form>
</body>
</html>
